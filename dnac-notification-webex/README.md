# DNAC_notification_to_WEBEX

  On Webex Teams, input "GO_Bot help":

  Functions:
  1. Get subscriptions : Get current Event Subscriptions;
  2. Create subscriptions {EventID} : Create new Event Subscriptions;
  3. Delete subscriptions {EventID} : Delete current Event Subscriptions;
  4. Show Events Description

# Prerequisites:

- DNA Center: Version 2.1.2.0

- Webex Teams

- Python 3.8.1

- nGrok

# Steps to get the Webex BOT working with DNAC

1. For Webex Teams, create a Webex Teams bot (save the API access `token` and username): https://developer.webex.com/my-apps/new/bot. On Webex Teams, create a team
   /space, save the `ROOM ID`;

2. For your PC, Sign up for  nGrok, then connect and start it on your machine (save the port number and public web address: https://ngrok.com/download
   After installing ngrok, run it on your local machine to get a public ip address, eg `./ngrok http https://localhost:5000 -host-header="localhost:5000" --region=eu`. Copy the ip address displayed in the ngrok window, ie: : `https://01b836a0e476.eu.ngrok.io`

3. For DNA center, need to create new instance for Webhook. Try to get its instanceId from POSTMAN;
   * Not found DNAC API interface to create instance for Webhook. So, need to manually create it.
   * While creating events subscriptions by DNAC API, need to input Webhook "instanceId", so, need to get it in advance.

4. There are four files to be used:
   * env_dnac_webex.py
     Environment variables. `WEBEX_TOKEN_BOT` and `DNAC_PASSWORD` value is stored in system OS env.
     `WEBEX_WEBHOOK_URL` is ngrok + 'webex-to-webhook'.
     `DNAC_WEBHOOK_URL` with above ngrok doesn't work perhaps due to the block on cisco device. Here, use the private IP address.
     `DNAC_Endpoint_instanceId` is the webhook instanceId. It's manullay created on DNAC. Not found corresponding DNAC API.
   * api_dnac_webex.py
     Define all related modules to talk with Webex and DNAC API interface.
   * dnac_events_id_name.json
     Includes almost all DNAC EventsId and its NAME for customer reference. It's generated by DNAC API interface.
   * dnac_notifications_to_webex.py
     Main procedure. Use python flask as server.
