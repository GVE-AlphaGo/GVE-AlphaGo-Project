{"version":3,"sources":["index.js"],"names":["default","Presence","payloadTransformer","predicates","name","direction","test","ctx","response","resolve","extract","transforms","fn","body","status","eventType","config"],"mappings":";;;;;;;;;;;;;;;AASA;;;;;6CA+BQA,O;;;;AApCR;;AAEA;;;;AAIA;;;;;;AAVA;;;;AAYA,uCAAuB,UAAvB,EAAmCC,kBAAnC,EAA6C;AAC3CC,sBAAoB;AAClBC,gBAAY,CACV;AACEC,YAAM,+BADR;AAEEC,iBAAW,SAFb;AAGEC,UAHF,gBAGOC,GAHP,EAGYC,QAHZ,EAGsB;AAClB;AACA,eAAO,kBAAQC,OAAR,CAAgB,mBAAID,QAAJ,EAAc,gBAAd,KAAmC,mBAAIA,QAAJ,EAAc,cAAd,CAAnD,CAAP;AACD,OANH;AAOEE,aAPF,mBAOUF,QAPV,EAOoB;AAChB,eAAO,kBAAQC,OAAR,CAAgBD,QAAhB,CAAP;AACD;AATH,KADU,CADM;AAclBG,gBAAY,CACV;AACEP,YAAM,+BADR;AAEEC,iBAAW,SAFb;AAGEO,QAHF,cAGKL,GAHL,EAGUC,QAHV,EAGoB;AAChBA,iBAASK,IAAT,CAAcC,MAAd,GAAuBN,SAASK,IAAT,CAAcE,SAArC;AACD;AALH,KADU;AAdM,GADuB;AAyB3CC;AAzB2C,CAA7C","file":"index.js","sourcesContent":["/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport '@webex/internal-plugin-device';\n\nimport {registerInternalPlugin} from '@webex/webex-core';\nimport {has} from 'lodash';\n\nimport Presence from './presence';\nimport config from './config';\n\nregisterInternalPlugin('presence', Presence, {\n  payloadTransformer: {\n    predicates: [\n      {\n        name: 'normalizeSingleStatusResponse',\n        direction: 'inbound',\n        test(ctx, response) {\n          // POST to /apheleia/api/v1/events\n          return Promise.resolve(has(response, 'body.eventType') && has(response, 'body.subject'));\n        },\n        extract(response) {\n          return Promise.resolve(response);\n        }\n      }\n    ],\n    transforms: [\n      {\n        name: 'normalizeSingleStatusResponse',\n        direction: 'inbound',\n        fn(ctx, response) {\n          response.body.status = response.body.eventType;\n        }\n      }\n    ]\n  },\n  config\n});\n\nexport {default} from './presence';\n"]}