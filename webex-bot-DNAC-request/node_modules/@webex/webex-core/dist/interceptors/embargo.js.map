{"version":3,"sources":["embargo.js"],"names":["EmbargoInterceptor","options","reason","statusCode","device","webex","internal","loggerMessage","join","clear","credentials","logger","info","reject","Interceptor"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;;;;AAEA;;;IAGqBA,kB;;;;;;;;;;;;AASnB;;;;;;oCAMgBC,O,EAASC,M,EAAQ;AAC/B,UAAIA,OAAOC,UAAP,KAAsB,GAA1B,EAA+B;AAAA,YACtBC,MADsB,GACZ,KAAKC,KAAL,CAAWC,QADC,CACtBF,MADsB;;AAE7B,YAAMG,gBAAgB,CACpB,qDADoB,EAEpB,gDAFoB,EAGpBC,IAHoB,CAGf,EAHe,CAAtB;;AAKA,YAAIJ,MAAJ,EAAY;AACV,eAAKC,KAAL,CAAWC,QAAX,CAAoBF,MAApB,CAA2BK,KAA3B;AACD;;AAED,aAAKJ,KAAL,CAAWK,WAAX,CAAuBD,KAAvB;AACA,aAAKJ,KAAL,CAAWM,MAAX,CAAkBC,IAAlB,CAAuBL,aAAvB;AACD;;AAED,aAAO,kBAAQM,MAAR,CAAeX,MAAf,CAAP;AACD;;;;AA/BD;;;6BAGgB;AACd;AACA,aAAO,IAAIF,kBAAJ,CAAuB,EAACK,OAAO,IAAR,EAAvB,CAAP;AACD;;;EAP6CS,qB,GAThD;;;;kBASqBd,kB","file":"embargo.js","sourcesContent":["/*!\n * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {Interceptor} from '@webex/http-core';\n\n/**\n * @class\n */\nexport default class EmbargoInterceptor extends Interceptor {\n  /**\n   * @returns {EmbargoInterceptor}\n   */\n  static create() {\n    /* eslint no-invalid-this: [0] */\n    return new EmbargoInterceptor({webex: this});\n  }\n\n  /**\n   * @see Interceptor#onResponseError\n   * @param {Object} options\n   * @param {Error} reason\n   * @returns {Promise}\n   */\n  onResponseError(options, reason) {\n    if (reason.statusCode === 451) {\n      const {device} = this.webex.internal;\n      const loggerMessage = [\n        'Received `HTTP 451 Unavailable For Legal Reasons`, ',\n        'discarding credentials and device registration'\n      ].join('');\n\n      if (device) {\n        this.webex.internal.device.clear();\n      }\n\n      this.webex.credentials.clear();\n      this.webex.logger.info(loggerMessage);\n    }\n\n    return Promise.reject(reason);\n  }\n}\n"]}